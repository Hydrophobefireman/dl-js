var parser=new DOMParser;function unpack(code){var env={eval:function(c){code=c},window:{},document:{}};return eval("with(env) {"+code+"}"),code=(code+"").replace(/;/g,";\n").replace(/{/g,"\n{\n").replace(/}/g,"\n}\n").replace(/\n;\n/g,";\n").replace(/\n\n/g,"\n"),code}function og_search(page,what){var resp=page.querySelector("meta[property='og:"+what+"']")||page.querySelector("meta[name='og:"+what+"']")||page.querySelector("meta[itemprop='og:"+what+"']");return resp?resp.getAttribute("content"):resp}function decodehtml(html){var txt=document.createElement("textarea");return txt.innerHTML=html,txt.value}function get_yt_id(url){return 0==(url=new URL(url)).search.length?url.pathname.substring(1):parseqs(url.search).v}function vidzi(page,base_url){var data={};return data.base_url=base_url,data.video_urls=[],data.thumbnail="http://null",funcre=/eval\(function\(p[\s\S]*?\)\)\)/,page=parser.parseFromString(page,"text/html"),evald=unpack(funcre.exec(page.body.innerHTML)[0]),data.title=page.title,mp4re=/file:"(http.*?mp4)"/,url=mp4re.exec(evald)[1],data.video_urls.push({url:url,quality:"highest"}),data}function megadrive(page,base_url){var data={};return data.base_url=base_url,page=parser.parseFromString(page,"text/html"),data.title=og_search(page,"title"),data.thumbnail=og_search(page,"image"),reg=/mp4:["']([\s\S]*?)['"],/,data.video_urls=[],data.video_urls.push({url:reg.exec(page.body.innerHTML),quality:"Default"}),data}function instagram(page,base_url){var data={};return data.base_url=base_url,data.video_urls=[],page=parser.parseFromString(page,"text/html"),data.title=page.title,data.thumbnail=og_search(page,"image"),video=page.querySelector("meta[property='og:video']"),null==video?(data.image__=data.thumbnail,data):(data.video_urls.push({url:video.getAttribute("content"),quality:"default"}),data)}function streamango(page,base_url){var re=new RegExp(/eval\(function\(p[\s\S]*?var\s*?srces=[\s\S]*?}\);/),data={video_urls:[]};for(var t in page=parser.parseFromString(page,"text/html"),script_=re.exec(page.body.innerHTML)[0],eval(script_),data.title=og_search(page,"title"),data.thumbnail=og_search(page,"image"),data.base_url=base_url,srces)ret=srces[t],url=ret.src,-1==url.indexOf("http")&&(url="https:"+url),q=ret.height,data.video_urls.push({url:url,quality:q});return data}function rapidvideo(page,base_url){return estream(page,base_url)}function watcheng(page,base_url){var data={video_urls:[]};return page=parser.parseFromString(page,"text/html"),data.title=page.title,data.thumbnail=page.getElementsByTagName("video")[0].getAttribute("poster"),data.base_url=base_url,sources=page.getElementsByTagName("source")[0],data.video_urls.push({url:sources.src,quality:"default"}),data}function estream(page,base_url){var data={video_urls:[]};page=parser.parseFromString(page,"text/html"),data.title=page.title,thumbnail=og_search(page,"image"),data.thumbnail=thumbnail||"//null",data.base_url=base_url,sources=page.getElementsByTagName("source");for(var i=0;i<sources.length;i++)el=sources[i],-1==el.getAttribute("src").indexOf("m3u8")&&data.video_urls.push({url:el.getAttribute("src"),quality:el.getAttribute("res")||el.getAttribute("label")||el.getAttribute("data-res")});return data}function yourupload(page,base_url){var data={video_urls:[]};return page=parser.parseFromString(page,"text/html"),re=/file:\s'(.*?mp4)(?=\',)/,url=re.exec(page.body.innerHTML)[1],data.video_urls.push({url:url,quality:"Highest"}),data.base_url=base_url,data.thumbnail=og_search(page,"image"),data.title=og_search(page,"title")||page.title,data}function youtube(page,url){var mp3_=document.getElementById("btn-mp3");mp3_.style.display="block";var data={youtube:!0};data.base_url=url,page=parser.parseFromString(page,"text/html"),re=new RegExp(/ytplayer.config\s=\s(.*?)(?=;ytplayer.)/,"m");try{var tmp=re.exec(page.body.innerHTML)[1];js=JSON.parse(tmp)}catch(e){document.getElementById("errs").innerHTML="An Unknown Error occured",document.getElementById("errs").style.color="red",console.log(e),window.location="//dl-py.herokuapp.com/video?url="+encodeURIComponent(url),alert("Age Restricted Video Detected.using python parser")}var title=js.args.title,basejs="https://www.youtube.com"+js.assets.js,thumbnail="https://i.ytimg.com/vi/"+js.args.video_id+"/hqdefault.jpg"||js.args.thumbnail_url;data.title=title,data.basejs=basejs,data.thumbnail=thumbnail,data.video_urls=[],urls=js.args.url_encoded_fmt_stream_map.split(","),audio_urls=js.args.adaptive_fmts;var highest=0;if(data.ytaudio=!0,void 0==audio_urls)mp3_.innerHTML="No audio url found for this video",data.ytaudio=!1;else{var signature_audio;audio_urls=audio_urls.split(","),mp3_.innerHTML="Click here for mp3 version of this video";for(var i=0;i<audio_urls.length;i++)qs=parseqs(audio_urls[i]),qs.url.indexOf("audio")>-1&&(qs.bitrate,highest=qs.bitrate,audio_url=decodeURIComponent(qs.url),signature_audio=qs.s);data.audio_url=[],data.audio_url.push({url:audio_url,sig_:signature_audio})}if(null!=parseqs(urls[0]).s)return console.log("Fetch Signature Functions"),void youtube_signatures(urls,data,data.basejs);for(var i=0;i<urls.length;i++)qs=parseqs(urls[i]),qs.url.indexOf("ratebypass")>-1&&data.video_urls.push({url:decodeURIComponent(qs.url),quality:qs.quality});return data}function youtube_signatures(urls,data,url){var xhr=new XMLHttpRequest;console.log(data),xhr.open("GET","/youtube/js/?url="+encodeURIComponent(url),!0),xhr.onload=function(){if(200===xhr.status){ret=JSON.parse(xhr.response);var sig_js=document.createTextNode(ret.sig_js),func_name=ret.funcname,scrpt=document.createElement("script");scrpt.appendChild(sig_js),document.body.appendChild(scrpt);for(var i=0;i<urls.length;i++)qs=parseqs(urls[i]),qs.url.indexOf("ratebypass")>-1&&(sig=qs.s,console.log(sig),new_sig=window[func_name](sig),url=decodeURIComponent(qs.url)+"&signature="+new_sig,data.video_urls.push({url:url,quality:qs.quality}));sig=window[func_name](data.audio_url[0].sig_),console.log(sig),data.audio_url[0].url+="&signature="+sig,start_create_video(data)}},xhr.send()}function offer_proxy(){for(var els_=document.getElementsByClassName("proxy_403"),er=0;er<els_.length;er++)els_[er].style.display="block"}function get_videos(url){var req=new Request("/videos/fetch/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"url="+encodeURIComponent(url)});fetch(req).then(ret=>ret.json()).then(res=>{if(res.hasOwnProperty("error"))document.getElementById("errs").innerHTML=res.error;else{if(res.hasOwnProperty("redirect"))return document.getElementById("errs").innerHTML="Redirecting to server extractor",void(window.location=res.redirect);page=res.html,funcname=res.funcname,url=res.landing_url;try{data=window[funcname](page,url)}catch(e){throw document.getElementById("errs").innerHTML="An Unknown Error Occured",e}console.log(data),"undefined"!=typeof data&&start_create_video(data)}})}function parseqs(query){var params={};query="?"==query[0]?query.substring(1):query;for(var vars=(query=decodeURI(query)).split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");params[pair[0]]=pair[1]}return params}function create_video(data){var div_=document.getElementById("videos");if(data.image__){document.body.innerHTML="<img src="+data.image__+">";var b=document.createElement("div");return b.innerHTML=data.title,void document.body.appendChild(b)}data.youtube&&data.ytaudio&&(document.getElementById("btn-mp3url").href="/mp3extract/?mp3u="+encodeURIComponent(data.audio_url[0].url)),json_data=data,document.title=json_data.title,document.getElementById("title").innerHTML=json_data.title,0==json_data.video_urls.length&&(document.getElementById("errs").innerHTML="No Playable Video Found..please Check if the video exists");for(var i=0;i<json_data.video_urls.length;i++){var h3=document.createElement("div");h3.innerText=decodehtml(json_data.title);var h5=document.createElement("div");h5.innerText="Quality:"+json_data.video_urls[i].quality,h3.style.fontWeight="bold",h3.style.marginTop="10px",h3.appendChild(h5);var v=document.createElement("video"),source=document.createElement("source"),url=decodehtml(json_data.video_urls[i].url);source.src=url,source.type="video/mp4",source.onerror=function(){offer_proxy()},v.poster=json_data.thumbnail,v.controls="True",v.height="225",v.width="400",v.setAttribute("class","vid"),v.preload="none",v.appendChild(source);var a1=document.createElement("div"),a2=document.createElement("a");a2.href=url;var proxy_=document.createElement("button");proxy_.setAttribute("class","proxy_403"),proxy_.style.display="none",proxy_.innerHTML="View this video",proxy_.onclick=function(){window.location="/fetch_url/?u="+encodeURIComponent(url)+"&referer="+encodeURIComponent(json_data.base_url)},a2.innerText="Direct Link to Video File",a1.appendChild(a2),div_.appendChild(v),div_.appendChild(proxy_),div_.appendChild(h3),div_.appendChild(document.createElement("br")),div_.appendChild(a1)}hpg=document.createElement("a"),hpg.href="/",hpg.innerHTML="Homepage";var prnt=document.createElement("div");prnt.appendChild(hpg),div_.appendChild(prnt),document.getElementById("skelly").style.display="none",document.getElementById("dlfail").style.display="block"}function start_create_video(data){try{create_video(data)}catch(e){document.getElementById("errs").innerHTML="An Unknown Error occured",document.getElementById("errs").style.color="red",console.log(e)}}